apiVersion: v1
data:
  tpm_client.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVHVENDQXdHZ0F3SUJBZ0lCQ3pBTkJna3Foa2lHOXcwQkFRc0ZBREJNTVFzd0NRWURWUVFHRXdKVlV6RVAKTUEwR0ExVUVDZ3dHUjI5dloyeGxNUk13RVFZRFZRUUxEQXBGYm5SbGNuQnlhWE5sTVJjd0ZRWURWUVFEREE1VAphVzVuYkdVZ1VtOXZkQ0JEUVRBZUZ3MHlOREEwTURFeU1qTTBOVE5hRncwek5EQTBNREV5TWpNME5UTmFNRkl4CkN6QUpCZ05WQkFjTUFsVlRNUTh3RFFZRFZRUUtEQVpIYjI5bmJHVXhFekFSQmdOVkJBc01Da1Z1ZEdWeWNISnAKYzJVeEhUQWJCZ05WQkFNTUZHTnNhV1Z1ZEdwM2RDNWtiMjFoYVc0dVkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQgpBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF6M2w2RFlndnpMRk90QmRwanJGVUZwVlBNWTFvN1lXRWJBM0l2aG5nCkFHc0l4SkdQcVVRejcrNzJ0bUhDbTFvam1VeS9tVWg4N2JuaEZUdHdCVVFUTUtkSk5sek9WZ0JrUXV5d01rWHkKV3Jrc21EWWQrbllZQ0hNSHdDT1IyL20xcGFjTnkwNzh3Y3lQRCtwWjBHVytnT1I4cmZaL3hrT1NFczdsZ2ZVcgo0aklWdDBjUXVwZFRFeWVzc1FRMkVVQUlQZGhpb2JpRWFqaW51UW9ZM1pGUmRVeWlESlgwMEw1dTUrV2wvYkJDCmRkQU5hY01QbG52Q1dtMXZQampZQ2hkQU9hb0NWZkRiQUJVOTkydG9QSnhmRkpjNllzY0h1MVF5YnM0YkJHNDcKMk9hTU5pN2hSbko4SytGZ3BsMEZrQ0luU3FWWUVkV2lnMk42SkNpaW1yZWlWd0lEQVFBQm80SC9NSUg4TUE0RwpBMVVkRHdFQi93UUVBd0lIZ0RBSkJnTlZIUk1FQWpBQU1CMEdBMVVkRGdRV0JCUVc3elloeUhLeHkzdUtWMEFkClY3NmVJNmdMWnpBZkJnTlZIU01FR0RBV2dCVHM4T3BUVXorZkk5ekJEakVRTndmZTN1ZHU4ekJGQmdnckJnRUYKQlFjQkFRUTVNRGN3TlFZSUt3WUJCUVVITUFLR0tXaDBkSEE2THk5d2Eya3VaWE52WkdWdGIyRndjREl1WTI5dApMMk5oTDNKdmIzUXRZMkV1WTJWeU1Eb0dBMVVkSHdRek1ERXdMNkF0b0N1R0tXaDBkSEE2THk5d2Eya3VaWE52ClpHVnRiMkZ3Y0RJdVkyOXRMMk5oTDNKdmIzUXRZMkV1WTNKc01Cd0dBMVVkRVFRVk1CT0NFV05zYVdWdWRDNWsKYjIxaGFXNHVZMjl0TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFCWTFvY0ZzUlB3NlhSVCtVQVpoWUl5UVM3ZQpzOTB5ZFFFSHNjcUs2Q0VjemJxRmdUeVlRRERWUFcvbk9BVnQvZTFaUGhPWHVCVnk1TXY2dllmWTNCV3pwYWVlCmRndFQwamlOZmpXb3RoQkJ5WWZjY2xKRFNSb1lhY0dVZ1UxM2FQNERNcTJ0VzdNbVBSR2lKRkI1ZG9HMkR5UGMKSkZIZnlmY3JDLzNUYndLRDh4bmhvSktUWkVaZ0xwa3NjczRaK1VKTmEySDY5OSs0NTY2K21xNGJlVGNNTUhLZApWYVBCQTRGVHZDeDJQNFg3MzNUbHlKZFJtRFpFZ3p0cFNKVys3Zno0cU5rTjdsVmNNWGhFQUdnQmlXZGdER01NCitMeUY5eFRGVVppTE9MY0xwMXhURkJyTUpiNkhIL2p5SzJGU24zQnl4bWtOMmRybEdKU0w0MkgrNDFDYgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  tpm_client.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2QUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktZd2dnU2lBZ0VBQW9JQkFRRFBlWG9OaUMvTXNVNjAKRjJtT3NWUVdsVTh4aldqdGhZUnNEY2krR2VBQWF3akVrWStwUkRQdjd2YTJZY0tiV2lPWlRMK1pTSHp0dWVFVgpPM0FGUkJNd3AwazJYTTVXQUdSQzdMQXlSZkphdVN5WU5oMzZkaGdJY3dmQUk1SGIrYldscHczTFR2ekJ6SThQCjZsblFaYjZBNUh5dDluL0dRNUlTenVXQjlTdmlNaFczUnhDNmwxTVRKNnl4QkRZUlFBZzkyR0todUlScU9LZTUKQ2hqZGtWRjFUS0lNbGZUUXZtN241YVg5c0VKMTBBMXB3dytXZThKYWJXOCtPTmdLRjBBNXFnSlY4TnNBRlQzMwphMmc4bkY4VWx6cGl4d2U3VkRKdXpoc0VianZZNW93Mkx1RkdjbndyNFdDbVhRV1FJaWRLcFZnUjFhS0RZM29rCktLS2F0NkpYQWdNQkFBRUNnZ0VBTXhaazlQY1BXaFpnM0Z5VmUvTHpVenBCeldCV01ZSjZpSWJlWXQwSk9PRWkKUUJEZHNKN2dNUmtFL0FUWGdCeHlmcG1VNWtBZ3J3TGh4eklqRTlEZTd0Q0thUTN5S3VBZTBCSHJFdjRCUHRDeApCK3Z2ZHRCa2U1UWptTzdKU0VMVk5TeU02MzZRSTRKa3lkVDVkNlRPQTN2L3JYQndweGZWWExkQWNUODNKcE9mCmpRK0JTeDZJeTZQV2xNUVRBNWdiaFQvZVBNYjVjTGJTMFNkcm4zSU9QU2orVkJBYldNblZkL0V5cWMvcHZVWlIKWjk4ZzdMMndPalFKYW12b1lMSjNzMjcvY3daT1ZXd2QxNngxWDZvZ3RyV1IyMjRTNFJxcFlzSGlTNGx1QjlIVQpjYVI1dFM4YjRpSk9ZaCtjUmxNNmE1bE9YcFhESXp5c041V3ZKVG41TlFLQmdRRCs1eUZVWmIvRkNQWnprT3k4CjhpNGhIVUJnNUs4ckxRUzFFVWE2YmRFMjFLT0ZFSHpjQ3YrQit3RWFsUzZjNGdBeHFDN1VyYmsvNVByZGQvaXoKRDFaQ3N4dlZMWXZLdWJTMzJVc3pEbmw3SjB6c1N2eEhsOUJDdzQyY1N6elFTc0pDMVBKQjlIS1NwSGtxRUpXdwplM0U0YkdlemhrSXh4ZnZWUXpSZWVUeXZ2UUtCZ1FEUVhoWXpFN05ZN092emIwSEM0SGhQRjVmSTc2Mk16UXJtCmJzYnZEMC96N3NMK3QwcFd5d3FaVysySm41ZUJrRnBPUmVPeHlTUkhKVzlXMjM2c25zTk0xR1V2d0VzV3pKZXAKYlBTZkhhbHVuQlpwOXlWSm5FanNhdzRvby9TNWcyZDlLTWQrekJqcGpJTWVJK2pJVXRBd1JOUGJPcUVrb0VBYwp6ZEw3QWpRQm93S0JnQ05FLzh1WnVJc2V6bHIzTm9wK1IvdTAvRzlydFFFWVhZcGdOWlVlRk5DdFkyTEtBVHpCCkdORjNWWlBFQ0lzVWlrcFVwd1l1YzI5djAzWkpYMVFIVHp3elpDcCsvdFN5RlZ0SzZhaksyK3c2Wjk1YUVjWW0KTDE3TmlBNlVLbm4zbmlGNUxYd0t3citmbWxSRHJ6S1lJZlpZcVpDaGh3ODBBY0JrYUI2YVQ5ZFJBb0dBUTl4Zwpub0hzQnlvaUxrWXR4S29XaEt2S1kwYXIzdzlvWFdQMnBpVDJoUnRkcGxkTGZyamgydEIxckR5dHV5U29SSlcrCmNraHY2RHZvNXdEVllLTFVPRkYwSXZrZGUyOW1kV2Rtdyt1Rkl1RHk2OC94OU9kUldLNEZEbmRYWEpQUFFKUG4KWlFSVG1MeUtkMlo2aWNOdXlrbWdOZVlDVlV0YmxnWHlrSTFISXNFQ2dZQXZ1WUFBVnlRYkhUZWFpZ1JnaXpEeQphQ0pFU2hYSWFrcTZwSjg0YjRxWm5RR2FsOWR6ZzkreFZSUHdReTMzQStraUR5RTlkdjJJeXozekxrZS9JUmJMCjNiYlUrdkR1dzJnZzUwWTZaQjU2SXdUendTTTEvNnRJOWM0YStwL2Y2aWRyVEttU1h4UkFtOFYyS1BUZGM4RTMKdDBUYkNKR3ZYakxUaUE5cFp2REhFUT09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
  root.pem: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURkakNDQWw2Z0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREJNTVFzd0NRWURWUVFHRXdKVlV6RVAKTUEwR0ExVUVDZ3dHUjI5dloyeGxNUk13RVFZRFZRUUxEQXBGYm5SbGNuQnlhWE5sTVJjd0ZRWURWUVFEREE1VAphVzVuYkdVZ1VtOXZkQ0JEUVRBZUZ3MHlNekV5TWpjeE56TTRNREphRncwek16RXlNall4TnpNNE1ESmFNRXd4CkN6QUpCZ05WQkFZVEFsVlRNUTh3RFFZRFZRUUtEQVpIYjI5bmJHVXhFekFSQmdOVkJBc01Da1Z1ZEdWeWNISnAKYzJVeEZ6QVZCZ05WQkFNTURsTnBibWRzWlNCU2IyOTBJRU5CTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQwpBUThBTUlJQkNnS0NBUUVBdlU1THBiQkV4SXJnZ3MveTRqQUNDSnZETVlJcGZFbVJKS25yODI0dStKZFJiYkpVCnZvN3BHQmprSkc5T25ueUN3OUViQ256eGI1QTNPbHdtLzBvcmNsUGNlaUtQNWFzVUUrbEV2Z05nT3REZDVaVmgKUUlSYjV4a0JYOGFIWFVmNjRncHV2WjE3c1lpc2o2T1BsN2R0VndPamJMOTdKUjd3dWduQ1IzNEs2N2pEbitlSAp5YUZMRDNES2RRdnVzNDZqbXBMMkdHVmE0RGVNNzBpN3pVVTFoUkVaM05qeGI0MmwxKzlJRlo4YVIvb1czWGNwCmFRWnRIdGtkVDRaaDMydTRrZkZEdG9Ea1pTQm1rS3JSVGFZOU9YeWlHWTRXcDJHaThoaExFeVh1RzNJNHVZODgKVUszTmlQcmNDS1ZuamcrS3lHYU5FMUFrd3grb3g2bFdmOE1WUHdJREFRQUJvMk13WVRBT0JnTlZIUThCQWY4RQpCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVTdQRHFVMU0vbnlQY3dRNHhFRGNICjN0N25idk13SHdZRFZSMGpCQmd3Rm9BVTdQRHFVMU0vbnlQY3dRNHhFRGNIM3Q3bmJ2TXdEUVlKS29aSWh2Y04KQVFFTEJRQURnZ0VCQUhlcVZnTUVPWWI4eUdtTHd3S3VoMFBwcjJaZy9mRGZtRDd6OGVxN2pocEF6aGpTdENpVAo1RTBjRlJTSkk0VVFmOC8yTjdSa3lJNVhaMEV1Q0E4WmgrWjZpa3JtazVLV1V5Y1pJU1E0eHk5RFo3NmtoVHprCnNCRFhGSFpJNklIZ3Vub214UE1kdW1HOXpaWk9uZmEyNWExcWVjQ0pBYWtlbTFTVmwyNzdtUmVFZjdhZ0JhRUwKUWFiSTA2UUk5dGIvYng2VWg5RERTOXFLU3FwQ3FHQXNWU1d4WXJ5alZBN2VTallIZU8wcTdkRGkyRVZGODA1UApIRCtsWFZtL1htYjA5bmNiaDVEQWVKU3FxQnVEYlEvNWd6SmJHSGdibVVaaFpFWmhnTDNZUFdybGI4ODN4cjh5CnlhQnU5SlZPM2djMXJ5N1ZINTFzKzdSWjI1Qzd1VVJEUUpJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t
kind: Secret
metadata:
  name: app-secrets
  namespace: default
type: Opaque
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: app-service-account
  namespace: default
automountServiceAccountToken: false
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app
  labels:
    type: app-service
spec:
  replicas: 1
  selector:
    matchLabels:
      name: app-service
  template:
    metadata:
      labels:
        name: app-service
        allowtpm: "true"
    spec:
      serviceAccountName: app-service-account
      automountServiceAccountToken: true
      containers:
      - name: app
        image: docker.io/salrashid123/tpmds-client@sha256:d6fc53a4bc03c6462aa61d6c04cb7ef7c41558d56cc199e411334b6e5170df19
        command:
          - /bin/bash
          - -c
          - sleep 3600
        volumeMounts:
          - mountPath: /certs
            name: certs
            readOnly: true
        env:
          - name: MY_NODE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
          - name: MY_NODE_IP
            valueFrom:
              fieldRef:
                fieldPath: status.hostIP
          - name: MY_POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: MY_POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
          - name: MY_POD_IP
            valueFrom:
              fieldRef:
                fieldPath: status.podIP
          - name: MY_POD_SERVICE_ACCOUNT
            valueFrom:
              fieldRef:
                fieldPath: spec.serviceAccountName
      volumes:
      - name: certs
        secret:
          secretName: app-secrets
    

